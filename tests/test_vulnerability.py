import unittest
from scanner.vulnerability import Vulnerability


class TestVulnerability(unittest.TestCase):
    def test_vulnerability_creation(self):
        vulnerability = Vulnerability(
            "XSS", "Cross-Site Scripting vulnerability", "High")

        self.assertEqual(vulnerability.name, "XSS")
        self.assertEqual(vulnerability.description,
                         "Cross-Site Scripting vulnerability")
        self.assertEqual(vulnerability.severity, "High")

    def test_vulnerability_string_representation(self):
        vulnerability = Vulnerability(
            "SQL Injection", "SQL Injection vulnerability in login form", "Medium")

        expected_string = "Name: SQL Injection\nSeverity: Medium\nDescription: SQL Injection vulnerability in login form"
        self.assertEqual(str(vulnerability), expected_string)


if __name__ == '__main__':
    unittest.main()
